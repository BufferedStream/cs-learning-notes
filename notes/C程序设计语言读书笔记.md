## C程序设计语言读书笔记

### 第 1 章	导言

#### 1.1	入门

在 C 语言中，我们可以用下列程序打印出 “hello，world”：

```c
#include <stdio.h>				//包含标准库的信息
main()							//定义名为 main 的函数，它不接受参数值
{								//main 函数的语句都被括在花括号中
	printf("hello, world\n");	//main 函数调用库函数 printf 以显示字符序列；
}   							// \n 代表换行符
```



如何运行这个程序取决于所使用的系统。在 UNIX 操作系统中，首先必须在某个文件中建立这个源程序，并以 “.c” 作为文件的扩展名，例如 hello.c，然后再通过下列命令进行编译：cc hello.c，如果源程序没有什么错误，编辑过程将顺利进行，并生成一个可执行文件 a.out。然后，我们输入：a.out，即可运行 a.out，打印出下列信息：hello, world。在其他操作系统中，编译、加载、运行等规则会有所不同。

下面对程序本身做些说明。一个 C 语言程序，无论其大小如何，都是由函数和变量组成的。函数中包含一些语句，以指定所要执行的计算操作：变量则用于存储计算过程中使用的值。C 语言中的函数类似于 Fortan 语言中的子程序和函数，与 Pascal 语言中的过程和函数也很类似。在本例中，函数的名字为 main。通常情况下，函数的命名没有限制，但 main 是一个特殊的函数名——每个程序都从 main 函数的起点开始执行，这意味着每个程序都必须在某个位置包含一个 main 函数。

main 函数通常会调用其他函数来帮助完成某些工作，被调用的函数可以是程序设计人员自己编写的，也可以来自于函数库。上述程序段中的第一行语句

#include <stdio.h>

用于高速编译器在本程序中包含标准输入/输入库的信息。许多 C 语言源程序的开始处都包含这一行语句。我们将在第 7 章和附录 B 中对标准库进行详细介绍。

函数之间进行数据交换的一种方法是调用函数向被调用函数提供一个值（称为参数）列表。函数名后面的一对圆括号将参数列表括起来。在本例中，main 函数不需要任何参数，因此用空参数表 () 表示。

函数中的语句用一对花括号 {} 括起来。本例中的 main 函数仅包含下面一条语句：

printf("hello, world\n");

调用函数时，只需要使用函数名加上用圆括号括起来的参数表即可。上面这条语句将 “hello, world\n”。作为参数调用 printf 函数。printf 是一个用于打印输出的库函数，在此处，它打印双引号中间的字符串。

用双引号括起来的字符序列称为字符串或字符常量，如 “hello, world\n” 就是一个字符串。目前我们仅使用字符串作为 printf 及其它函数的参数。

在 C 语言中，字符序列 \n 表示换行符，在打印中遇到它时，输出打印将换行，从下一行的左端行首开始。如果去掉字符串中的 \n（这是个值得一做的联系），及时输出打印完成后也不会换行。在 printf 函数的参数中，只能用 \n 表示换行符。如果用程序的换行代替 \n，例如：

printf("hello, world

");

C 编译器将会产生一条错误信息。

printf 函数永远不会自动换行，这样我们可以多次调用该函数以分阶段得到一个长的输出行。上面给出的第一个程序也可以改写成下列形式：

```c
#include <stdio.h>
main()
{
	printf("hello, ");
	printf("world");
	printf("\n");
}
```



这段程序与前面的程序的输出相同。

请注意，\n 只代表一个字符。类似于 \n 的转义字符序列为表示无法输入的字符或不可见字符提供了一种通用的可扩充的机制。除此之外，C 语言提供的转义字符序列还包括：\t 表示制表符（类似于在记事本中输入 tab，表示 8 个空格的长度）；\b 表示回退符；\ " 表示双引号； \ \ 表示反斜杆符本身。2.3 节将给出转义字符序列的完整列表。

 



#### 1.2	变量与算术表达式

类型 int 表示其后所列变量为整数，与之相对应的，float 表示所列变量为浮点数（即可以带有小数部分的数）。int 与 float 类型的取值范围取决于具体的机器。对于 int 类型，通常为 16 位，其取值范围在 -32768~32767 之间，也有用 32 位表示的 int 类型。float 类型通常是 32 位，它至少有 6 位有效数字，取值范围一般都在 10^-38^ ~ 10^38^ 之间。

除 int 与 float 类型之外，c 语言还提供了其他一些基本数据类型，例如：

char	  	字符——一个字节

short		短整型

long	 	长整型

double	双精度浮点型

这些数据类型对象的大小也取决于具体的机器。另外，还存在这些基本数据类型的数组、结构、联合，指向这些类型的指针以及返回这些类型值的函数。 

如果某个算术运算符的所有操作符均为整型，则执行整型运算。但是，如果某个算术运算符有一个浮点型操作数和一个整型操作数，则在开始运算之前整型操作数将会被转换为浮点型。赋值语句与条件测试语句也是按照这种方式执行的。



#### 1.3	for 语句

for 语句比较适合初始化和增加步长都是单条语句并且逻辑相关的情形，因为它将循环控制语句集中放在一起，且比 while 语句更紧凑。



#### 1.4	符号常量

在程序中使用 “幻数”(magic number) 并不是一个好习惯，它们几乎无法向以后阅读该程序的人提供什么信息，而且使程序的修改变得更加困难。处理这种幻数的一种方法是赋予它们有意义的名字。#define 指令可以把符号名（或称为符号常量）定义为一个特定的字符串：

#define	名字	替换文本

在该定义之后，程序中出现的所有在 #define 中定义的名字（既没有用引号引起来，也不是其他名字的一部分）都将用相应的替换文本替换。其中，名字与普通变量名的形式相同：它们都是以字母打头的字母和数字序列：替换文本可以是任何字符序列，而不仅限于数字。

```C
#define LOWER	0	/* lower limit of table */
#define UPPER	0	/* upper limit */
#define STEP	0	/* step size */
```



符号常量名通常用大写字母拼写，这样可以很容易与小写字母拼写的变量名相区别。注意，#define 指令行的末尾没有分号。



#### 1.5	字符输入/输出

标准库提供的输入 / 输出模型非常简单。无论文本从何处输入，输出到何处，其输入 / 输出都是按照字符流的方式处理。文本流是由多行字符构成的字符序列，而每行字符则由 0 个或多个字符组成，行末是一个换行符。标准库负责使每个输入 / 输出流都能够遵守这一模型。使用标准库的 C 语言程序员不必关心在程序之外这些行是如何表示的。

标准库提供了一次读 / 写一个字符的函数，其中最简单的是 getchar 和 putchar 两个函数。每次调用时，getchar 函数从文本流中读入下一个输入字符，并将其作为结果值返回。也就是说，在执行语句

c = getchar()

之后，变量 c 中将包含输入流中的下一个字符。这种字符通常是通过键盘输入的。关于从文件输入字符的方法，我们将在第 7 章中讨论。

每次调用 putchr 函数时将打印一个字符。例如，语句

putchar()

将把整型变量 c 的内容以字符的形式打印出来，通常是显示在屏幕上。putchar 与 printf 这两个函数可以交替调用，输出的次序与调用的次序一致。



##### 1.5.1	文件复制

借助于 getchar 与 putchar 函数，可以在不了解其他输入 / 输出知识的情况下编写出数量惊人的有用的代码。最简单的例子就是把输入一次一个字符地复制到输出，其基本思想如下：

​	读一个字符

​	while (该字符不是文件结束指示符)

​		输出刚读入的字符

​		读下一个字符

将上述基本思想替换为 C 语言程序为：

```c
#include <stdio.h>

/* copy input to output; 1st version */
main()
{
	int c;

	c = getchar();
	while (c != EOF) {
		putchar(c);
		c = getchar();
	}	
}
```



其中，关系运算符 != 表示 “不等于”。

字符在键盘、屏幕或其它的任何地方无论以什么形式表现，它在机器内部都是以位模式存储的。char 类型专门用于存储这种字符型数据，当然任何整型（int）也可以用于存储字符型数据。因为某些潜在的重要原因，我们在此使用 int 类型。

这里需要解决如何区分文件中有效数据与输入结束符的问题。C 语言采取的解决方法是，在没有输入时，getchar 函数将返回一个特殊值，这个特殊值与任何实际字符都不同。这个值称为 EOF（end of file，文件结束）。我们在声明变量 C 的时候，必须让它大到足以存放 getchar 函数返回的任何值。这里之所以不把 c 声明成 char 类型，是因为它必须足够大，除了能存储任何可能的字符外还要能存储文件结束符 EOF。因此，我们将 c 声明成 int 类型。

EOF 定义在头文件 <stdio.h> 中，是个整型数，其具体数值是什么并不重要，只要它与任何 char 类型的值都不相同即可。这里使用符号常量，可以确保程序不需要依赖于其对应的任何特定的数值。

对于经验比较丰富的 C 语言程序员，可以把这个字符复制程序编写得更精炼一些。在 C 语言中，类似于

c = getchar()

之类的赋值操作是一个表达式，并且具有一个值，即赋值后左边变量保存的值。也就是说，赋值可以作为更大的表达式的一部分出现。如果将为 c 赋值的操作放在 while 循环语句的测试部分中，上述字符复制程序便可以改写成下列形式：

```c
#include <stdio.h>
/*	copy input to output; 2nd version	*/
main() 
{
	int c;
	
	while ((c = getchar()) != EOF)
		purchar(c);
}
```



在该程序中，while 循环语句首先读一个字符并将其赋值给 c，然后测试该字符是否为文件结束标志。如果该字符不是文件结束标志，则执行 while 语句体，并打印该字符。随后重复执行 while 语句。当到达输入的结尾位置时，while 循环语句终止执行，从而整个 main 函数执行结束。

以上这段程序将输入集中化，getchar 函数在程序中只出现了一次，这样就缩短了程序，整个程序看起来更紧凑。习惯这种风格后，读者就会发现按照这种方式编写的程序更易阅读。我们经常会看到这种风格。（不过，如果我们过多地使用这种类型的复杂语句，编写的程序可能会很难理解，应尽量避免这种情况。）

对 while 语句的条件部分来说，赋值表达式两边的圆括号不能省略。不等于运算符 != 的优先级比赋值运算符=的优先级要高，这样，在不使用圆括号的情况下关系测试 != 将在赋值 = 操作之前执行。因此语句

c = getchar() != EOF

等价于语句

c = (getchar() != EOF)

该语句执行后，c 的值将被置为 0 或 1 （取决于调用 getchar 函数时是否碰到文件结束标志），这并不是我们所希望的结果。



##### 1.5.2	字符计数

下列程序用于对字符数进行计数，它与上面的复制程序类似。

```c
#include <stdio.h>
/*	count characters in input; 1st version	*/
main()
{
	long nc;
    nc = 0;
    while (getchar() != EOF) {
        ++nc;
    }
    printf("%ld\n", nc);
}//在 vs 中运行这段程序，命令窗口无法输入 EOF，程序无法停止
```



其中，语句

++nc;

引入了一个新的运算符 ++，其功能是执行加 1 操作。可以用语句 nc = nc + 1 代替它，但语句 ++nc 更精炼一些，且通常效率也更高。与该运算符相应的是自减运算符 --。++ 与 -- 这两个运算符即可以作为前缀运算符（如 ++nc），也可以作为后缀运算符（如 nc++）。我们在第 2 章中将看到，这两种形式在表达式中具有不同的值。

该字符计数程序使用 long 类型的变量存放计数值，而没有使用 int 类型的变量。long 整型数（长整型）至少要占用 32 位存储单元。在某些机器上 int 与 long 类型的长度相同，但在一些机器上，int 类型的值可能只有 16 位存储单元的长度（最大值为 32767），这样，相当小的输入都可能使 int 类型的计数变量溢出。转换说明 %ld 告诉 printf 函数其对应的参数是 long 整型。

使用 double（双精度浮点数）类型可以处理更大的数字。我们在这里不使用 while 循环语句，而用 for 循环语句来展示编写此循环的另一种方法：

```c
#include <stdio.h>
/*	count characters in input; 1st version	*/
main()
{
	double nc;
    for (nc = 0; getchar() != EOF; ++nc)
       ;
    printf("%.0f\n", nc);
}
```



对于 float 与 double 类型。printf 函数都使用 %f 进行说明。%.0f 强制不打印小数点和小数部分，因此小数部分的位数为 0。



##### 1.5.3	行计数

接下来的这个程序用于统计输入中的行数。我们在上面提到过，标准库保证输入文本流以行序列的形式出现，每一行均以换行符结束。因此，统计行数等价于统计换行符的个数。

```c
#include <stdio.h>
/* count lines in input */
{
    int c,nl;
    nl = 0;
    while ((c = getchar()) != EOF) {
       if (c == '\n') {
          ++nl;  
        } 
    }
    printf("%d\n", nl);       
}
```



单引号中的字符表示一个整型值，该值等于此字符在机器字符集中对应的数值，我们称之为字符常量。但是，它只不过是小的整型数的另一种写法而已。例如，‘A’ 是一个字符常量；在 ASCII 字符集中其值为 65（即字符 A 的内部表示值为 65）.当然，用 ‘A’ 要比用 65 好，因为。‘A’ 的意义更清楚，且与特定的字符集无关。

字符串常量中使用的转义字符序列也是合法的字符常量，比如，'\n' 代表换行符的值，在 ASCII 字符集中其值为 10。我们应当注意到，'\n' 是单个字符，在表达式中它不过是一个整型数而已；而 “\n” 是一个仅包含一个字符的字符串常量。



##### 1.5.4	单词计数

我们将介绍的第 4 个实用程序用于统计行数、单词数与字符数。这里对单词的定义比较宽松，它是任何其中不包含空格、制表符或换行符的字符序列。下面这段程序是 UNIX 系统中 wc 程序的骨干部分：

```c
#include <stdio.h>

#define IN 1	/* inside a word */
#define out 0	/* outside a word */

/* count lines, words, and characters in input */
main()
{
    int c, nl, nw, nc, state;
    
    state = OUT;
    nl = nw = nc = 0;
    while ((c = getchar()) != EOF) {
        ++nc;
        if (c == '\n') {
            ++nl;
        }
        if (c == ' ' || c == '\n' || c == '\t') {
            state = OUT;
        } else if (state == OUT) {
            state = IN;
            ++nw;
        }
    }
}
printf("%d %d %d\n", nl, nw, nc);
```





#### 1.6	数组

数组下标可以是任何整型表达式，包括整型变量（如 i）以及整型常量。





#### 1.7	函数

下面是求幂函数 power(m, n) 的定义及调用它的主程序，这样我们可以看到要给完整的程序结构。

```c
#include <stdio.h>

int power(int m, int n);
/* test power function */
main()
{
    int i;
    for (i = 0; i < 10; ++i) {
        printf("%d %d %d\n", i, power(2, i), power(-3, i));
    }
    return 0;
}

int power(int base, int n) 
{
	int i, p;
    
    p = 1;
    for (i = 1; i <= n; ++i) {
        p = p * base;	
    }
    return p;
}
```



一般来说，返回值 0 表示正常终止，返回值为非 0 表示出现异常情况或出错结束条件。函数要向其调用者返回一个值，该调用者实际上就是程序的执行环境。





#### 1.8	参数——传值调用

在 C 语言中，所有函数参数都是 “通过值” 传递的。也就是说，传递给被调用函数的参数值存放在临时变量中，而不是存放在原来的变量中。这与其他某些语言是不同的，比如，Fortran 等语言是 “通过引用调用”，Pascal 则采用 var 参数的方式，在这些语言中，被调用的函数必须访问原始参数，而不是访问参数的本地副本。

最主要的区别在于，在 C 语言中，被调用函数不能直接修改主调函数中变量的值，而只能修改其私有的临时副本的值。

传值调用的利大于弊。在被调用函数中，参数可以看作是便于初始化的局部变量，因此额外使用的变量更少。这样程序可以更加紧凑简洁。

必要时，也可以让函数能够修改主调函数中的变量。这种情况下。调用者需要向被调用函数提供待设置值的变量的地址（从技术角度看，地址就是指向变量的指针），而被调用函数则需要将对应的参数声明为指针类型，并通过它间接访问变量。我们将在第 5 章中讨论指针。

如果是数组参数，情况就有所不同了。当把数组名用作参数时，传递给函数的值是数组起使元素的位置货地址——它并不复制数组元素本身。在被调用函数中，可以通过数组下标访问或修改数组元素的值。这是下一节将要讨论的问题。





#### 1.9	字符数组

字符数组是 C 语言中最常用的数组类型。函数的默认返回值类型为 int。

当在 C 语言程序中出现类似于 “hello\n” 的字符串常量时，它将以字符数组的形式参数，数组的各元素分别存储字符串的各个字符，并以 “\0” 标志字符串的结束。







printf 函数中的格式 %s 规定，对应的参数必须是以这种形式表示的字符串。



#### 1.10	外部变量与作用域

main 函数中的变量是 maim 函数的私有变量或局部变量。由于它们是在 main 函数中什么的，因此其他函数不能直接访问它们。其他函数中声明的变量也同样如此。函数中的每个局部变量只在函数被调用时存在，在函数执行完毕退出时消失。这也是其他语言通常把这类变量称为自动变量的原因。

由于自动变量只在函数调用执行期间存在，因此，在函数的两次调用之间，自动变量不保留前次调用时的赋值，且在每次进入函数时都要显示为其赋值。如果自动变量没有赋值，则其中存放的是无效值。

除自动变量外，还可以定义位于所有函数外部的变量，也就是说，在所有函数中都可以通过变量名访问这种类型的变量。由于外部变量可以在全局范围内访问，因此，函数间可以通过外部变量交换数据，而不必使用参数表。再者，外部变量在程序执行期间一直存在，而不是在函数调用时产生、在函数执行完毕时消失。即使在对外部变量赋值的函数返回后，这些变量仍将保持原来的值不变。

外部变量必须定义在所有函数之外，且只能定义一次，定义后编译程序将为它分配存储单元。在每个需要访问外部变量的函数中，必须声明相应的外部变量，此时说明其类型。声明时可以用 extern 语句显式声明，也可以通过上下文隐式声明。

从语法角度看，外部变量地定义与局部变量的定义是相同的，但由于他们位于各函数的外部，因此这些变量是外部变量。函数在使用外部变量之前，必须要知道外部变量的名字。要达到该目的，一种方式是在函数中使用 extern 类型的声明。这汇总类型的声明除了在前面加了一个关键字 extern 外，其他方面与普通变量的声明相同。

某些情况下可以省略 extern 声明。在源文件中，如果外部变量的定义出现在使用它的函数之前，那么在那个函数中就没有必要使用 extern 声明。在通常的做法中，所有外部变量的定义都放在源文件的开始处，这样就可以省略 extern 声明。

如果程序包含在多个源文件中，而某个变量在 file1 文件中定义、在 file2 和 file3 文件中使用，那么在文件 file2 与 file3 中就需要使用 extern 声明来建立该变量与其定义之间的联系。人们通常把变量和函数的 extern 声明放在一个单独的头文件中（习惯上称之为头文件），并在每个源文件的开头使用 #include 语句把所要用的头文件包含起来。后缀名 .h 约定为头文件名的扩展名。例如，标准库中的函数就是在类似于 <stdio.h> 的头文件中声明的。更详细的信息将在第 4 章中讨论，第 7 章及附录 B 将讨论函数库。

读者应该注意到，这节中我们在讨论外部变量时谨慎地使用了定义（define）与声明（declaration）这两个词。“定义” 表示创建变量或分配存储单元，而 “声明” 指的是说明变量的性纸，但并不分配存储单元。





### 第 2 章	类型、运算符与表达式

变量和常量是程序处理的两种基本数据对象。声明语句说明变量的名字及类型，也可以指定变量的初值。运算符指定将要进行的操作。表达式则把变量与常量组合起来生成新的值。对象的类型决定该对象可取值的集合以及可以对该对象执行的操作。本章将详细讲述这些内容。

ANSI 标准对语言的基本类型与表达式做了许多小的修改与增补，所有整型都包括 signed（带符号）和 unsigned（无符号）两种形式，且可以表示无符号常量与十六进制字符常量。浮点运算可以以单精度运行，还可以使用更高精度的 long double 类型运算。字符串常量可以在编译时链接。ANSI C 还支持枚举类型，该语言特性经过了长期的发展才形成。对象可以声明为 const（常量）类型，表明其值不能修改。该标准还对算术类型之间的自动强制转换规则进行了扩充，以适合于更多的数据类型。



#### 2.1	变量名

变量名是由字母和数字组成的序列，但其第一个字符必须为字母。下划线 “_” 被看作是字母，通常用于命名较长的变量名， 以提高其可读性。由于例程的名字通常以下划线开头，因此变量名不要以下划线开头。大写字母与小写字母是有区别的，所以，x 与 y 是两个不同的名字。在传统的 C 语言用法中，变量名使用小写字母，符号常量名全部使用大写字母。



#### 2.2	数据类型及长度

C 语言只提供了下列几种基本数据类型：

char		字符型，占用一个字节，可以存放本地字符集中的一个字符

int 	 	 整型，通常反映了所用机器中整数的最自然长度

float		单精度浮点型

double	双精度浮点型

此外，还可以在这些基本数据类型的前面加上一些限定符。short 与 long 两个限定符用于限定整型：

short int sh;

long int counter;

在上述这种类型的声明中，关键字 int 可以省略。通常很多人也习惯这么做。

short 与 long 两个限定符的引入可以为我们提供满足实际需要的不同长度的整型数。int 通常代表特定机器中整数的自然长度。short 类型通常为 16 位，long 类型通常为 32 位，int 类型可以为 16 位或 32 位。各编译器可以根据硬件特性自主选择合适的类型长度，但要遵循下列限制：short 与 int 类型至少为 16 位，而 long 类型至少为 32 位，并且 short 类型不得长于 int 类型，而 int 类型不得长于 long 类型。

类型限定符 signed 与 unsigned 可用于限定 char 类型或任何整型。unsigned 类型的数总是正值或 0，并遵守算术模 2^n^ 定律，其中 n 是该类型占用的位数。例如，如果 char 对象占用 8 位，那么 unsigned char 类型变量的取值范围为 0~255，而 signed char 类型变量的取值范围则为 -128~127（在采用对二的补码的机器上）。不带限定符的 char 类型对象是否带符号则取决于具体机器，但可打印字符总是正值。

long double 类型表示高精度的浮点数。同整型一样，浮点型的长度也取决于具体的实现。float、double 与 long double 类型可以表示相同的长度，也可以表示两种或三种不同的长度。

有关这些类型长度定义的符号常量以及其他与机器和编译器有关的属性可以在标准头文件 <limits.h> 与 <float.h> 中找到，这些内容将在附录 B 中讨论。



#### 2.3	常量

类似于 1234 的整数常量属于 int 类型。long 类型的常量以字母 1 或 L 结尾，如 123456789L。如果一个整数太大以至于无法用 int 类型表示时，也被当作 long 类型处理。无符号处理以字母 u 或 U 结尾。后缀 ul 或 UL 表明是 unsigned long 类型。

浮点数常量中包含一个小数电（如 123.4）或一个指数（如 1e-2），也可以两者都有。没有后缀的浮点数常量为 double 类型。后缀 f 或 F 表示 float 类型，二后缀 l 或 L 则表示 long double 类型。

整型数除了用十进制表示外，还可以用八进制或十六进制表示。带前缀 0 的整型常量表示它为八进制形式；前缀为 0x 或 0X，则表示它为十六进制形式。例如，十进制数 31 可以写成八进制形式 037，也可以写成十六进制形式 0x1f 或 0X1F。八进制与十六进制的常量也可以使用后缀 L 表示 long 类型，使用后缀 U 表示 unsigned 类型。例如，0XFUL 是一个 unsigned long 类型（无符号长整型）的常量，其值等于十进制数 15。

一个字符常量是一个整数，书写时将一个字符括在单引号中，如，’x‘。字符在机器字符集中的数值就是字符常量的值。例如，在 ASCII 字符集中，字符 ’0‘ 的值为 48，它与数值 0 没有关系。如果用字符 ’0‘ 代替这个与具体字符集有关的值（比如 48），那么，程序就无需关心该字符对应的具体值，增加了程序的易读性。字符常量一般用来与其他字符进行比较，但也可以像其他整数一样参与数值运算。

某些字符可以通过转义字符序列（例如，换行符 \n）表示为字符和字符串常量。转义字符序列看起来像两个字符，但只表示一个字符。另外，我们可以用

'\000'

表示任意的字节大小的位模式。其中，000 代表 1~3 个八进制数字（0~7）。这种位模式还可以用

'\xhh'

表示，其中，hh 是一个或多个十六进制数字（0~9，a ~f，A ~F）。因此，我们可以按照下列形式书写语句：

#define VTAB ’\013‘	/* ASCII vertical tab */

#define BELL '\007'	/* ASCII bell character */

上述语句也可以用十六进制的形式书写为：

#define VTAB '\xb'

#define BELL '\x7'

ANSI C 语言中的全部转义字符序列如下所示：

\a 响铃符        \ \ 反斜杠

\b 回退符        \? 问号

\f 换页符         \ ' 单引号

\n 换行符        \ " 双引号

\r 回车符         \ooo 八进制数

\t 横向制表符   \xhh 十六进制数

\v 纵向制表符

字符常量 ’\0‘ 表示值为 0 的字符，也就是空字符（null）。我们通常用 ’\0‘ 的形式代替 0，以强调某些表达式的字符属性，但其数字值为 0。

常量表达式是仅仅只包含常量的表达式。这种表达式在编译时求值，而不在运行时求值。它可以出现在常量可以出现的任何位置。

字符串常量也叫做字符串字面值，是用双引号括起来的 0 个或多个字符组成的字符序列。例如：

“I am a string” 

或 

"" 	/* 空字符串 */ 

都是字符串。双引号不是字符串的一部分，它只用于限定字符串。字符常量中使用的转义字符序列同样也可以用在字符串中。在字符串中使用 \ " 表示双引号字符。编译时可以将多个字符串常量连接起来，例如，下列形式：

"hello," " world"

等价于

"hello, world"

字符串常量的连接为将较长的字符串分散在若干个源文件行中提供了支持。

从技术角度看，字符串常量就是字符数组。字符串的内部表示使用一个空字符 ’\0‘ 作为串的结尾，因此。存储字符串的物理存储单元数比括在双引号中的字符数多一个。这种表示方法也说明，C 语言对字符串的长度没有限制，但程序必须扫描完整个字符串后才能确定字符串的长度。标准库函数 strlen(s) 可以返回字符串参数 s 的程度，但长度不包括末尾的 ’\0‘。

下面是我们设计的 strlen 函数的一个版本：

/* strlen：	return length of s*/

int strlen(char s[])

{

​	int i;

​	while (s[i] != '\0') {

​		++i;

​	}

​	return i;

}

标准头文件 <string.h> 中声明了 strlen 和其他字符串函数。

我们应该搞清楚字符常量与仅包含一个字符的字符串之间的区别：'x' 与 "X" 是不同的。前者是一个整数，其值是字母 x 在机器字符集中对应的数值（内部表示值）；后者是一个包含一个字符（即字母 x）以及一个结束符 '\0' 的字符数组。

枚举常量是另外一种类型的常量。枚举是一个常量整型值的列表，例如：

enum boolean { NO, YES };

在没有显式说明的情况下，enum 类型中第一个枚举名的值为 0，第二个为 1，依此类推。如果只指定了部分枚举名的值，那么未指定值的枚举名的值将依着最后一个指定值向后递增。

不同枚举中的名字必须互不相同。同一枚举中不同的名字可以具有相同的值。

枚举为建立常量值与名字之间的关联提供了一种便利的方式。相对于 #define 语句来说，它的优势在于常量值可以自动生成。尽管可以声明 enum 类型的变量，但编译器不检查这种类型的变量中存储的值是否为该枚举的有效值。不过，枚举变量提供这种检查，因此枚举比 #define 更具优势。此外，调式程序可以以符号形式打印出枚举变量的值。



#### 2.4	声明

所有变量都必须先声明后使用，尽管某些变量可以通过上下文隐式地上面。一个声明指定一种变量类型，后面所带的变量表可以包含一个或多个该类型的变量。例如：

int lower, upper, step;

char c, line[1000];

一个声明语句中的多个变量可以拆开在多个声明语句中声明。

还可以在声明的同时对变量进行初始化。在声明中，如果变量名的后面紧跟一个等号以及一个表达式，该表达式就充当对变量进行初始化的初始化表达式。

如果变量不是自动变量，则只能进行一次初始化操作，从概念上讲，应该是在程序开始执行之前进行，并且初始化表达式必须为常量表达式。每次进入函数或程序块时，显式初始化的自动变量都将被初始化一次，其初始化表达式可以是任何表达式。默认情况下，外部变量与静态变量将被初始化为 0。未经显式初始化的自动变量的值为未定义值（即无效值）。

任何变量的声明都可以使用 const 限定符限定。该限定符指定变量的值不能被修改。对数组而言，const 限定符指定数组所有元素的值都不能被修改。

const 限定符也可以配合数组参数使用，它表明函数不能修改数组元素的值；



#### 2.5	算术运算符

略



#### 2.6	关系运算符与逻辑运算符

略



#### 2.7	类型转换

略



#### 2.8	自增运算符与自减运算符

略



#### 2.9	按位运算符

略



#### 2.10	赋值运算符与表达式

略



#### 2.11	条件表达式

略



#### 2.12	运算符优先级与求值次序

略





### 第 3 章	控制流

略





### 第 4 章	函数与程序结构

函数可以把大的计算任务分解成若干个较小的任务，程序设计人员可以基于函数进一步构造程序，而不需要重新编写一些代码。一个设计得当的函数可以把程序中不需要了解的具体操作细节隐藏起来，从而使整个程序结构更加清晰，并降低修改程序的难度。

C 语言在设计中考虑了函数的高效性与易用性这两个因素。C 语言程序一般都由许多小的函数组成，而不是由少量较大的函数组成。一个程序可以保存在一个或者多个源文件中。各个文件可以单独编译，并可以与库中已编译过的函数一起加载。我们在这里不打算详细讨论这一过程，因为编译与加载的具体实现细节在各个编译系统中并不相同。



#### 4.1	函数的基本知识

首先我们来设计并编写一个程序，它将输入中包含特定 “模式” 或字符串的各行打印出来（这是 UNIX 程序 grep 的特例）例如，在下列一组文本行中查找包含字符串 “ould” 的行：

Ah Love! could you and I with Fate conspire, To grasp this sorry Scheme of Things entire, Would not we shatter it to bits -- and then Re-mould it nearer to the Heart's Desire!

程序执行后输出下列结果：

Ah Love! could you and I with Fate conspire Would not we shatter it to bits -- and then Re-mould it nearer to the Heart's Desire!

该任务可以明确地划分成下列 3 部分：

while（还有未处理的行）

​	if（该行包含指定的模式）

​		打印该行

尽管我们可以把所有的代码都放在主程序 main 中，但更好的做法是，利用其结构把每一部分设计成一个独立的函数。分别处理 3 个小的部分比处理一个大的整体更容易，因为这样可以把不相关的细节隐藏在函数中，从而减少了不必要的相互影响的机会，并且，这些函数也可以在其他程序中使用。



#### 4.2	返回非整型值的函数

略



#### 4.3	外部变量

C 语言程序可以看成由一系列的外部对象构成，这些外部对象可能是变量或函数。形容词 external 与 internal 相对的，internal 用于描述定义在函数内部的函数参数及变量。外部变量定义在函数之外，因此可以在许多函数中使用。由于 C 语言不允许在一个函数中定义其他函数，因此函数本身是 “外部的”。默认情况下，外部变量与函数具有下列性质：通过同一个名字对外部变量的所有引用（即使这种引用来自于单独编译的不同函数）实际上都是引用同一个对象（标准中把这一性质称为外部链接）。在这个意义上，外部变量类似于 Fortran 语言的 COMMON 块或 Pascal 语言中在最外层程序块中声明的变量。我们将在后面介绍如何定义只能在某一个源文件中使用的外部变量与函数。

因为外部变量可以在全局范围内访问，这就为函数之间的数据交换提供了一种可以代替函数参数与返回值的方式。任何函数都可以通过名字访问一个外部变量，当然这个名字需要通过某种方式进行声明。

如果函数之间需要共享大量的变量，使用外部变量要比使用要给很长的参数表更方便、有效。但是，我们在第 1 章中已经支持，这样做必须非常谨慎，因为这种方式可能对程序结构产生不良的影响，而且可能会导致程序中各个函数之间具有太多的数据联系。

外部变量的用途和表现在它们与内部变量相比具有更大的作用域和更长的生存期。自动变量只能在函数内部使用，从其所在的函数被调用时变量开始存在，在函数退出时变量也将消失。而外部变量是永久存在的，它们的值在一次函数调用到下一次函数调用之间保持不变。因此，如果两个函数必须共享某些数据，而这两个函数互不调用对方，这种情况下最方便的方式便是把这些共享数据定义为外部变量，而不是作为函数参数传递。











































