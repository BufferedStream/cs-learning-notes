## C程序设计语言读书笔记

### 第 1 章	导言

#### 1.1	入门

在 C 语言中，我们可以用下列程序打印出 “hello，world”：

```c
#include <stdio.h>				//包含标准库的信息
main()							//定义名为 main 的函数，它不接受参数值
{								//main 函数的语句都被括在花括号中
	printf("hello, world\n");	//main 函数调用库函数 printf 以显示字符序列；
}   							// \n 代表换行符
```



如何运行这个程序取决于所使用的系统。在 UNIX 操作系统中，首先必须在某个文件中建立这个源程序，并以 “.c” 作为文件的扩展名，例如 hello.c，然后再通过下列命令进行编译：cc hello.c，如果源程序没有什么错误，编辑过程将顺利进行，并生成一个可执行文件 a.out。然后，我们输入：a.out，即可运行 a.out，打印出下列信息：hello, world。在其他操作系统中，编译、加载、运行等规则会有所不同。

下面对程序本身做些说明。一个 C 语言程序，无论其大小如何，都是由函数和变量组成的。函数中包含一些语句，以指定所要执行的计算操作：变量则用于存储计算过程中使用的值。C 语言中的函数类似于 Fortan 语言中的子程序和函数，与 Pascal 语言中的过程和函数也很类似。在本例中，函数的名字为 main。通常情况下，函数的命名没有限制，但 main 是一个特殊的函数名——每个程序都从 main 函数的起点开始执行，这意味着每个程序都必须在某个位置包含一个 main 函数。

main 函数通常会调用其他函数来帮助完成某些工作，被调用的函数可以是程序设计人员自己编写的，也可以来自于函数库。上述程序段中的第一行语句

#include <stdio.h>

用于高速编译器在本程序中包含标准输入/输入库的信息。许多 C 语言源程序的开始处都包含这一行语句。我们将在第 7 章和附录 B 中对标准库进行详细介绍。

函数之间进行数据交换的一种方法是调用函数向被调用函数提供一个值（称为参数）列表。函数名后面的一对圆括号将参数列表括起来。在本例中，main 函数不需要任何参数，因此用空参数表 () 表示。

函数中的语句用一对花括号 {} 括起来。本例中的 main 函数仅包含下面一条语句：

printf("hello, world\n");

调用函数时，只需要使用函数名加上用圆括号括起来的参数表即可。上面这条语句将 “hello, world\n”。作为参数调用 printf 函数。printf 是一个用于打印输出的库函数，在此处，它打印双引号中间的字符串。

用双引号括起来的字符序列称为字符串或字符常量，如 “hello, world\n” 就是一个字符串。目前我们仅使用字符串作为 printf 及其它函数的参数。

在 C 语言中，字符序列 \n 表示换行符，在打印中遇到它时，输出打印将换行，从下一行的左端行首开始。如果去掉字符串中的 \n（这是个值得一做的联系），及时输出打印完成后也不会换行。在 printf 函数的参数中，只能用 \n 表示换行符。如果用程序的换行代替 \n，例如：

printf("hello, world

");

C 编译器将会产生一条错误信息。

printf 函数永远不会自动换行，这样我们可以多次调用该函数以分阶段得到一个长的输出行。上面给出的第一个程序也可以改写成下列形式：

```c
#include <stdio.h>
main()
{
	printf("hello, ");
	printf("world");
	printf("\n");
}
```



这段程序与前面的程序的输出相同。

请注意，\n 只代表一个字符。类似于 \n 的转义字符序列为表示无法输入的字符或不可见字符提供了一种通用的可扩充的机制。除此之外，C 语言提供的转义字符序列还包括：\t 表示制表符（类似于在记事本中输入 tab，表示 8 个空格的长度）；\b 表示回退符；\ " 表示双引号； \ \ 表示反斜杆符本身。2.3 节将给出转义字符序列的完整列表。

 



#### 1.2	变量与算术表达式

类型 int 表示其后所列变量为整数，与之相对应的，float 表示所列变量为浮点数（即可以带有小数部分的数）。int 与 float 类型的取值范围取决于具体的机器。对于 int 类型，通常为 16 位，其取值范围在 -32768~32767 之间，也有用 32 位表示的 int 类型。float 类型通常是 32 位，它至少有 6 位有效数字，取值范围一般都在 10^-38^ ~ 10^38^ 之间。

除 int 与 float 类型之外，c 语言还提供了其他一些基本数据类型，例如：

char	  	字符——一个字节

short		短整型

long	 	长整型

double	双精度浮点型

这些数据类型对象的大小也取决于具体的机器。另外，还存在这些基本数据类型的数组、结构、联合，指向这些类型的指针以及返回这些类型值的函数。 

如果某个算术运算符的所有操作符均为整型，则执行整型运算。但是，如果某个算术运算符有一个浮点型操作数和一个整型操作数，则在开始运算之前整型操作数将会被转换为浮点型。赋值语句与条件测试语句也是按照这种方式执行的。



#### 1.3	for 语句

for 语句比较适合初始化和增加步长都是单条语句并且逻辑相关的情形，因为它将循环控制语句集中放在一起，且比 while 语句更紧凑。



#### 1.4	符号常量

在程序中使用 “幻数”(magic number) 并不是一个好习惯，它们几乎无法向以后阅读该程序的人提供什么信息，而且使程序的修改变得更加困难。处理这种幻数的一种方法是赋予它们有意义的名字。#define 指令可以把符号名（或称为符号常量）定义为一个特定的字符串：

#define	名字	替换文本

在该定义之后，程序中出现的所有在 #define 中定义的名字（既没有用引号引起来，也不是其他名字的一部分）都将用相应的替换文本替换。其中，名字与普通变量名的形式相同：它们都是以字母打头的字母和数字序列：替换文本可以是任何字符序列，而不仅限于数字。

```C
#define LOWER	0	/* lower limit of table */
#define UPPER	0	/* upper limit */
#define STEP	0	/* step size */
```



符号常量名通常用大写字母拼写，这样可以很容易与小写字母拼写的变量名相区别。注意，#define 指令行的末尾没有分号。



#### 1.5	字符输入/输出

标准库提供的输入 / 输出模型非常简单。无论文本从何处输入，输出到何处，其输入 / 输出都是按照字符流的方式处理。文本流是由多行字符构成的字符序列，而每行字符则由 0 个或多个字符组成，行末是一个换行符。标准库负责使每个输入 / 输出流都能够遵守这一模型。使用标准库的 C 语言程序员不必关心在程序之外这些行是如何表示的。

标准库提供了一次读 / 写一个字符的函数，其中最简单的是 getchar 和 putchar 两个函数。每次调用时，getchar 函数从文本流中读入下一个输入字符，并将其作为结果值返回。也就是说，在执行语句

c = getchar()

之后，变量 c 中将包含输入流中的下一个字符。这种字符通常是通过键盘输入的。关于从文件输入字符的方法，我们将在第 7 章中讨论。

每次调用 putchr 函数时将打印一个字符。例如，语句

putchar()

将把整型变量 c 的内容以字符的形式打印出来，通常是显示在屏幕上。putchar 与 printf 这两个函数可以交替调用，输出的次序与调用的次序一致。



##### 1.5.1	文件复制

借助于 getchar 与 putchar 函数，可以在不了解其他输入 / 输出知识的情况下编写出数量惊人的有用的代码。最简单的例子就是把输入一次一个字符地复制到输出，其基本思想如下：

​	读一个字符

​	while (该字符不是文件结束指示符)

​		输出刚读入的字符

​		读下一个字符

将上述基本思想替换为 C 语言程序为：

```c
#include <stdio.h>

/* copy input to output; 1st version */
main()
{
	int c;

	c = getchar();
	while (c != EOF) {
		putchar(c);
		c = getchar();
	}	
}
```



其中，关系运算符 != 表示 “不等于”。

字符在键盘、屏幕或其它的任何地方无论以什么形式表现，它在机器内部都是以位模式存储的。char 类型专门用于存储这种字符型数据，当然任何整型（int）也可以用于存储字符型数据。因为某些潜在的重要原因，我们在此使用 int 类型。

这里需要解决如何区分文件中有效数据与输入结束符的问题。C 语言采取的解决方法是，在没有输入时，getchar 函数将返回一个特殊值，这个特殊值与任何实际字符都不同。这个值称为 EOF（end of file，文件结束）。我们在声明变量 C 的时候，必须让它大到足以存放 getchar 函数返回的任何值。这里之所以不把 c 声明成 char 类型，是因为它必须足够大，除了能存储任何可能的字符外还要能存储文件结束符 EOF。因此，我们将 c 声明成 int 类型。

EOF 定义在头文件 <stdio.h> 中，是个整型数，其具体数值是什么并不重要，只要它与任何 char 类型的值都不相同即可。这里使用符号常量，可以确保程序不需要依赖于其对应的任何特定的数值。

对于经验比较丰富的 C 语言程序员，可以把这个字符复制程序编写得更精炼一些。在 C 语言中，类似于

c = getchar()

之类的赋值操作是一个表达式，并且具有一个值，即赋值后左边变量保存的值。也就是说，赋值可以作为更大的表达式的一部分出现。如果将为 c 赋值的操作放在 while 循环语句的测试部分中，上述字符复制程序便可以改写成下列形式：

```c
#include <stdio.h>
/*	copy input to output; 2nd version	*/
main() 
{
	int c;
	
	while ((c = getchar()) != EOF)
		purchar(c);
}
```



在该程序中，while 循环语句首先读一个字符并将其赋值给 c，然后测试该字符是否为文件结束标志。如果该字符不是文件结束标志，则执行 while 语句体，并打印该字符。随后重复执行 while 语句。当到达输入的结尾位置时，while 循环语句终止执行，从而整个 main 函数执行结束。

以上这段程序将输入集中化，getchar 函数在程序中只出现了一次，这样就缩短了程序，整个程序看起来更紧凑。习惯这种风格后，读者就会发现按照这种方式编写的程序更易阅读。我们经常会看到这种风格。（不过，如果我们过多地使用这种类型的复杂语句，编写的程序可能会很难理解，应尽量避免这种情况。）

对 while 语句的条件部分来说，赋值表达式两边的圆括号不能省略。不等于运算符 != 的优先级比赋值运算符=的优先级要高，这样，在不使用圆括号的情况下关系测试 != 将在赋值 = 操作之前执行。因此语句

c = getchar() != EOF

等价于语句

c = (getchar() != EOF)

该语句执行后，c 的值将被置为 0 或 1 （取决于调用 getchar 函数时是否碰到文件结束标志），这并不是我们所希望的结果。



##### 1.5.2	字符计数

下列程序用于对字符数进行计数，它与上面的复制程序类似。

```c
#include <stdio.h>
/*	count characters in input; 1st version	*/
main()
{
	long nc;
    nc = 0;
    while (getchar() != EOF) {
        ++nc;
    }
    printf("%ld\n", nc);
}//在 vs 中运行这段程序，命令窗口无法输入 EOF，程序无法停止
```



其中，语句

++nc;

引入了一个新的运算符 ++，其功能是执行加 1 操作。可以用语句 nc = nc + 1 代替它，但语句 ++nc 更精炼一些，且通常效率也更高。与该运算符相应的是自减运算符 --。++ 与 -- 这两个运算符即可以作为前缀运算符（如 ++nc），也可以作为后缀运算符（如 nc++）。我们在第 2 章中将看到，这两种形式在表达式中具有不同的值。

该字符计数程序使用 long 类型的变量存放计数值，而没有使用 int 类型的变量。long 整型数（长整型）至少要占用 32 位存储单元。在某些机器上 int 与 long 类型的长度相同，但在一些机器上，int 类型的值可能只有 16 位存储单元的长度（最大值为 32767），这样，相当小的输入都可能使 int 类型的计数变量溢出。转换说明 %ld 告诉 printf 函数其对应的参数是 long 整型。

使用 double（双精度浮点数）类型可以处理更大的数字。我们在这里不使用 while 循环语句，而用 for 循环语句来展示编写此循环的另一种方法：

```c
#include <stdio.h>
/*	count characters in input; 1st version	*/
main()
{
	double nc;
    for (nc = 0; getchar() != EOF; ++nc)
       ;
    printf("%.0f\n", nc);
}
```



对于 float 与 double 类型。printf 函数都使用 %f 进行说明。%.0f 强制不打印小数点和小数部分，因此小数部分的位数为 0。



##### 1.5.3	行计数

接下来的这个程序用于统计输入中的行数。我们在上面提到过，标准库保证输入文本流以行序列的形式出现，每一行均以换行符结束。因此，统计行数等价于统计换行符的个数。

```c
#include <stdio.h>
/* count lines in input */
{
    int c,nl;
    nl = 0;
    while ((c = getchar()) != EOF) {
       if (c == '\n') {
          ++nl;  
        } 
    }
    printf("%d\n", nl);       
}
```



单引号中的字符表示一个整型值，该值等于此字符在机器字符集中对应的数值，我们称之为字符常量。但是，它只不过是小的整型数的另一种写法而已。例如，‘A’ 是一个字符常量；在 ASCII 字符集中其值为 65（即字符 A 的内部表示值为 65）.当然，用 ‘A’ 要比用 65 好，因为。‘A’ 的意义更清楚，且与特定的字符集无关。

字符串常量中使用的转义字符序列也是合法的字符常量，比如，'\n' 代表换行符的值，在 ASCII 字符集中其值为 10。我们应当注意到，'\n' 是单个字符，在表达式中它不过是一个整型数而已；而 “\n” 是一个仅包含一个字符的字符串常量。



##### 1.5.4	单词计数

我们将介绍的第 4 个实用程序用于统计行数、单词数与字符数。这里对单词的定义比较宽松，它是任何其中不包含空格、制表符或换行符的字符序列。下面这段程序是 UNIX 系统中 wc 程序的骨干部分：



































